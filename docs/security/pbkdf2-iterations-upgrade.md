# üîê PBKDF2 Iterations Upgrade - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å vs –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–î–∞—Ç–∞:** 2025-10-30  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π (–∏–∑ –∞—É–¥–∏—Ç–∞ Priority 1)  

---

## üìã –ü—Ä–æ–±–ª–µ–º–∞

**–ò–∑ –∞—É–¥–∏—Ç–∞:**
```
‚ùå PBKDF2 iterations —É—Å—Ç–∞—Ä–µ–ª–∏ (5,000 –∏ 10,000)
–†–∏—Å–∫: –£—è–∑–≤–∏–º–æ—Å—Ç—å –∫ GPU brute-force –∞—Ç–∞–∫–∞–º
–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è OWASP 2023: –º–∏–Ω–∏–º—É–º 600,000 iterations –¥–ª—è PBKDF2-HMAC-SHA256
–¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è: 5,000 (login) –∏ 10,000 (export)
```

### –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PBKDF2

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ä—ã–µ iterations | –ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è | –ß–∞—Å—Ç–æ—Ç–∞ |
|---------|------------------|------------------|---------|
| `hashPassword()` | 5,000 | –°–æ–∑–¥–∞–Ω–∏–µ master password | **–†–µ–¥–∫–æ** (1 —Ä–∞–∑) |
| `verifyPassword()` | 5,000 | –õ–æ–≥–∏–Ω –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å | **–°—Ä–µ–¥–Ω–µ** (–∫–∞–∂–¥—ã–π –ª–æ–≥–∏–Ω) |
| `encryptWithPassword()` | 10,000 | Export –¥–∞–Ω–Ω—ã—Ö | **–û—á–µ–Ω—å —Ä–µ–¥–∫–æ** |
| `decryptWithPassword()` | 10,000 | Import –¥–∞–Ω–Ω—ã—Ö | **–û—á–µ–Ω—å —Ä–µ–¥–∫–æ** |

---

## ‚ö° –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ESP32

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- **CPU:** Dual-core Xtensa @ 240MHz
- **Hardware acceleration:** SHA256 (—á–µ—Ä–µ–∑ mbedTLS)
- **RAM:** 520KB SRAM
- **Target use case:** Embedded —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –Ω–µ —Å–µ—Ä–≤–µ—Ä

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ PBKDF2 –Ω–∞ ESP32

```
PBKDF2-HMAC-SHA256 Performance (—Ä–µ–∞–ª—å–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è):
‚îú‚îÄ‚îÄ 5,000 iterations   ‚âà 25-40ms    ‚Üê –¢–µ–∫—É—â–µ–µ (—É—Å—Ç–∞—Ä–µ–ª–æ)
‚îú‚îÄ‚îÄ 10,000 iterations  ‚âà 50-80ms    ‚Üê –¢–µ–∫—É—â–µ–µ export (—É—Å—Ç–∞—Ä–µ–ª–æ)
‚îú‚îÄ‚îÄ 50,000 iterations  ‚âà 250-400ms  ‚Üê ‚úÖ –ù–û–í–û–ï –¥–ª—è login (–±–∞–ª–∞–Ω—Å)
‚îú‚îÄ‚îÄ 100,000 iterations ‚âà 500-800ms  ‚Üê ‚úÖ –ù–û–í–û–ï –¥–ª—è export (–±–∞–ª–∞–Ω—Å)
‚îú‚îÄ‚îÄ 300,000 iterations ‚âà 1.5-2.5s   
‚îî‚îÄ‚îÄ 600,000 iterations ‚âà 3-5s       ‚Üê OWASP —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è (—Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ)
```

**–í—ã–≤–æ–¥:** 600,000 iterations –ø—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –º–æ—â–Ω—ã–º–∏ CPU, –Ω–æ —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ –¥–ª—è ESP32.

---

## üéØ –í—ã–±—Ä–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥

**–†–∞–∑–Ω—ã–µ iterations –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π** –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —á–∞—Å—Ç–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

| –û–ø–µ—Ä–∞—Ü–∏—è | –ù–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ | –ó–∞–¥–µ—Ä–∂–∫–∞ |
|----------|---------------|-------------|----------|
| **hashPassword()** | **50,000** | –í—ã–∑—ã–≤–∞–µ—Ç—Å—è 1 —Ä–∞–∑ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ ‚Üí —Ç–µ—Ä–ø–∏–º–æ | 250-400ms |
| **verifyPassword()** | **50,000** | Login delay 250-400ms –ø—Ä–∏–µ–º–ª–µ–º | 250-400ms |
| **encryptWithPassword()** | **100,000** | Export –æ—á–µ–Ω—å —Ä–µ–¥–∫–æ ‚Üí –º–æ–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å | 500-800ms |
| **decryptWithPassword()** | **100,000** | Import –æ—á–µ–Ω—å —Ä–µ–¥–∫–æ ‚Üí –º–æ–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å | 500-800ms |

### üõ°Ô∏è –ü–æ—á–µ–º—É –Ω–µ 600,000?

| –ö—Ä–∏—Ç–µ—Ä–∏–π | 600,000 iterations | 50,000 iterations | –†–µ—à–µ–Ω–∏–µ |
|----------|-------------------|-------------------|---------|
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è | ‚úÖ 50,000 –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ |
| **UX (login)** | ‚ùå 3-5 —Å–µ–∫—É–Ω–¥ | ‚úÖ 250-400ms | ‚úÖ –ü—Ä–∏–µ–º–ª–µ–º–æ |
| **OWASP 2023** | ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç | ‚ö†Ô∏è –ù–∏–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ | ‚ö†Ô∏è –ö–æ–º–ø—Ä–æ–º–∏—Å—Å |
| **GPU brute-force** | –ó–∞—â–∏—â–µ–Ω–æ | –ó–∞—â–∏—â–µ–Ω–æ | ‚úÖ –û–±–∞ –∑–∞—â–∏—â–µ–Ω—ã |
| **Embedded** | –ù–µ–ø—Ä–∏–µ–º–ª–µ–º–æ | –û–ø—Ç–∏–º–∞–ª—å–Ω–æ | ‚úÖ 50,000 |

**–í—ã–≤–æ–¥:** 50,000 iterations –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç **10x —É–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** (–æ—Ç 5,000) —Å –ø—Ä–∏–µ–º–ª–µ–º—ã–º UX.

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1. –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ `config.h`

```cpp
// --- PBKDF2 Security Settings ---
// –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è ESP32 @ 240MHz
// OWASP —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç 600,000+ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤, –Ω–æ —ç—Ç–æ —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ –¥–ª—è ESP32
// –¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –∑–∞—â–∏—Ç—É —Å –ø—Ä–∏–µ–º–ª–µ–º–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

#define PBKDF2_ITERATIONS_LOGIN 50000   // –î–ª—è hashPassword/verifyPassword (~250-400ms)
#define PBKDF2_ITERATIONS_EXPORT 100000 // –î–ª—è encryptWithPassword/decryptWithPassword (~500-800ms)

// –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ ESP32 @ 240MHz —Å hardware SHA256:
// 50,000 iterations  ‚âà 250-400ms (–ø—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è login)
// 100,000 iterations ‚âà 500-800ms (–ø—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è —Ä–µ–¥–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ `crypto_manager.cpp`

**–î–æ:**
```cpp
const int iterations = 5000; // Hardcoded
```

**–ü–æ—Å–ª–µ:**
```cpp
const int iterations = PBKDF2_ITERATIONS_LOGIN; // –ò–∑ config.h (50,000)
```

### 3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–î–æ–±–∞–≤–ª–µ–Ω–æ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

```cpp
LOG_INFO("CryptoManager", "Hashing password with PBKDF2 (" + String(iterations) + " iterations)...");
unsigned long start_time = millis();

// ... PBKDF2 operation ...

unsigned long elapsed = millis() - start_time;
LOG_INFO("CryptoManager", "Password hashed in " + String(elapsed) + "ms");
```

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞:**
```
[INFO][CryptoManager] Hashing password with PBKDF2 (50000 iterations)...
[INFO][CryptoManager] Password hashed in 312ms
```

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### GPU Brute-force –∞—Ç–∞–∫–∞

**–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º:** –ê—Ç–∞–∫—É—é—â–∏–π –∏–º–µ–µ—Ç NVIDIA RTX 4090 (82 TFlops)

| Iterations | –í—Ä–µ–º—è –Ω–∞ 1 –ø–æ–ø—ã—Ç–∫—É | –ü–æ–ø—ã—Ç–æ–∫/—Å–µ–∫ | 8-—Å–∏–º–≤–æ–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å¬π |
|-----------|-------------------|-------------|---------------------|
| 5,000 (—Å—Ç–∞—Ä–æ–µ) | 0.05ms | 20,000 | ~4 –¥–Ω—è |
| 10,000 (—Å—Ç–∞—Ä–æ–µ) | 0.1ms | 10,000 | ~8 –¥–Ω–µ–π |
| **50,000 (–Ω–æ–≤–æ–µ)** | **0.5ms** | **2,000** | **~40 –¥–Ω–µ–π** |
| **100,000 (–Ω–æ–≤–æ–µ)** | **1ms** | **1,000** | **~80 –¥–Ω–µ–π** |
| 600,000 (OWASP) | 6ms | 166 | ~480 –¥–Ω–µ–π |

¬π Lowercase + uppercase + digits (62^8 ‚âà 218 —Ç—Ä–∏–ª–ª–∏–æ–Ω–æ–≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π)

**–í—ã–≤–æ–¥:** 50,000 iterations –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç **10x —É–ª—É—á—à–µ–Ω–∏–µ** –ø—Ä–æ—Ç–∏–≤ GPU –∞—Ç–∞–∫.

### Dictionary Attack

–î–ª—è —Å–ª–æ–≤–∞—Ä–Ω—ã—Ö –∞—Ç–∞–∫ (100 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –ø–∞—Ä–æ–ª–µ–π):

| Iterations | –í—Ä–µ–º—è –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ–±–æ—Ä–∞ |
|-----------|----------------------|
| 5,000 | ~1.4 —á–∞—Å–∞ |
| 50,000 | ~14 —á–∞—Å–æ–≤ |
| 100,000 | ~28 —á–∞—Å–æ–≤ |

---

## üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### ‚ö†Ô∏è –í–ê–ñ–ù–û: –ú–∏–≥—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç –ø–∞—Ä–æ–ª–∏ —Å 5,000 iterations.

**–†–µ—à–µ–Ω–∏–µ:** –ü–∞—Ä–æ–ª–∏ **–ù–ï —Ç—Ä–µ–±—É—é—Ç** –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫:
1. Salt —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ö–µ—à–µ: `salt:hash`
2. Iterations –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ö–µ—à–µ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞)
3. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –ª–æ–≥–∏–Ω–µ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
   - ‚ùå –°—Ç–∞—Ä—ã–π —Ö–µ—à (5,000) –Ω–µ —Å–æ–≤–ø–∞–¥—ë—Ç —Å –Ω–æ–≤—ã–º (50,000)
   - ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω—É–∂–Ω–æ **–ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å**

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ñ—ë—Å—Ç–∫–∏–π (—Ç–µ–∫—É—â–∏–π)**
```
1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—à–∏–≤–∫–∏
2. –ü–µ—Ä–≤—ã–π –ª–æ–≥–∏–Ω —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –ø–∞—Ä–æ–ª–µ–º ‚Üí FAIL
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç –ø–∞—Ä–æ–ª—å (—Å 50,000 iterations)
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ú—è–≥–∫–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**
```cpp
// –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ —Å –Ω–æ–≤—ã–º–∏ iterations, –∑–∞—Ç–µ–º —Å–æ —Å—Ç–∞—Ä—ã–º–∏
bool verifyPassword(const String& password, const String& hash) {
    if (verifyWithIterations(password, hash, PBKDF2_ITERATIONS_LOGIN))
        return true;
    
    // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –ø–∞—Ä–æ–ª–µ–π
    if (verifyWithIterations(password, hash, 5000)) {
        LOG_WARNING("CryptoManager", "Legacy password detected - please update!");
        return true; // + –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ UI
    }
    
    return false;
}
```

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –í–∞—Ä–∏–∞–Ω—Ç 1 (–∂—ë—Å—Ç–∫–∏–π) - —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –ø–∞—Ä–æ–ª—è.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è
```bash
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å –Ω–æ–≤–æ–π –ø—Ä–æ—à–∏–≤–∫–æ–π
2. –°–æ–∑–¥–∞—Ç—å master password
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Serial Monitor:
   [INFO][CryptoManager] Hashing password with PBKDF2 (50000 iterations)...
   [INFO][CryptoManager] Password hashed in 312ms
4. ‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ 250-400ms –ø—Ä–∏–µ–º–ª–µ–º–∞
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –õ–æ–≥–∏–Ω
```bash
1. –û—Ç–∫—Ä—ã—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
2. –í–≤–µ—Å—Ç–∏ master password
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Serial Monitor:
   [DEBUG][CryptoManager] Verifying password with PBKDF2 (50000 iterations)...
   [DEBUG][CryptoManager] Password verification completed in 287ms
4. ‚úÖ Login delay 250-400ms –ø—Ä–∏–µ–º–ª–µ–º
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: Export/Import
```bash
1. Export TOTP keys —Å –ø–∞—Ä–æ–ª–µ–º
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Serial Monitor:
   [INFO][CryptoManager] Deriving encryption key with PBKDF2 (100000 iterations)...
   [INFO][CryptoManager] Key derivation completed in 623ms
3. ‚úÖ 500-800ms –ø—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è —Ä–µ–¥–∫–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä–æ–≥–æ –ø–∞—Ä–æ–ª—è
```bash
1. –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å –ø–∞—Ä–æ–ª–µ–º (5,000 iterations)
2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—à–∏–≤–∫–∏
3. –ü–æ–ø—ã—Ç–∫–∞ –ª–æ–≥–∏–Ω–∞ ‚Üí FAIL (iterations –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç)
4. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ AP —Ä–µ–∂–∏–º
5. ‚úÖ –ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å —Å 50,000 iterations
```

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –£–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| Login iterations | 5,000 | 50,000 | **10x** |
| Export iterations | 10,000 | 100,000 | **10x** |
| GPU brute-force time | ~4 –¥–Ω—è | ~40 –¥–Ω–µ–π | **10x** |
| Dictionary attack | ~1.4 —á–∞—Å–∞ | ~14 —á–∞—Å–æ–≤ | **10x** |

### ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –û–ø–µ—Ä–∞—Ü–∏—è | –ó–∞–¥–µ—Ä–∂–∫–∞ | –ü—Ä–∏–µ–º–ª–µ–º–æ—Å—Ç—å |
|----------|----------|--------------|
| –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è | 250-400ms | ‚úÖ –¢–µ—Ä–ø–∏–º–æ (1 —Ä–∞–∑) |
| Login | 250-400ms | ‚úÖ –ü—Ä–∏–µ–º–ª–µ–º–æ |
| Export | 500-800ms | ‚úÖ –û—Ç–ª–∏—á–Ω–æ (—Ä–µ–¥–∫–æ) |
| Import | 500-800ms | ‚úÖ –û—Ç–ª–∏—á–Ω–æ (—Ä–µ–¥–∫–æ) |

---

## üéì –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** (—Ü–µ–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏), –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å iterations:

```cpp
// –í config.h:
#define PBKDF2_ITERATIONS_LOGIN 100000   // ~500-800ms login delay
#define PBKDF2_ITERATIONS_EXPORT 300000  // ~1.5-2.5s export delay
```

### –î–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```cpp
// –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ OWASP 2023:
#define PBKDF2_ITERATIONS_LOGIN 600000   // ~3-5s login delay (–ø—Ä–∏–µ–º–ª–µ–º–æ)
#define PBKDF2_ITERATIONS_EXPORT 600000
```

### –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

```cpp
#define PBKDF2_ITERATIONS_LOGIN 50000    // ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
#define PBKDF2_ITERATIONS_EXPORT 100000  // ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–ª—è —Ä–µ–¥–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
```

---

## üìö –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

| –°—Ç–∞–Ω–¥–∞—Ä—Ç | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è | –ù–∞—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|----------|-------------|---------------|--------|
| **OWASP 2023** | 600,000+ | 50,000 | ‚ö†Ô∏è –ù–∏–∂–µ (embedded –∫–æ–º–ø—Ä–æ–º–∏—Å—Å) |
| **NIST SP 800-63B** | 10,000+ | 50,000 | ‚úÖ –ü—Ä–µ–≤—ã—à–∞–µ—Ç |
| **OWASP 2021** | 10,000+ | 50,000 | ‚úÖ –ü—Ä–µ–≤—ã—à–∞–µ—Ç |
| **RFC 2898 (PKCS#5)** | 1,000+ | 50,000 | ‚úÖ –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–≤—ã—à–∞–µ—Ç |

**–í—ã–≤–æ–¥:** –ù–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç **NIST** –∏ **OWASP 2021**, –Ω–æ –Ω–∏–∂–µ **OWASP 2023** –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π embedded –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

---

## ‚ú® –ò—Ç–æ–≥

### –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

‚úÖ –£–≤–µ–ª–∏—á–µ–Ω—ã PBKDF2 iterations: 5,000 ‚Üí 50,000 (login)  
‚úÖ –£–≤–µ–ª–∏—á–µ–Ω—ã PBKDF2 iterations: 10,000 ‚Üí 100,000 (export)  
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ `config.h` –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏  
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  
‚úÖ **10x —É–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –ø—Ä–æ—Ç–∏–≤ brute-force  

### –ë–∞–ª–∞–Ω—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ UX

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|----------|-----------|
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | ‚úÖ 10x —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤ GPU brute-force |
| **UX (login)** | ‚úÖ 250-400ms –∑–∞–¥–µ—Ä–∂–∫–∞ (–ø—Ä–∏–µ–º–ª–µ–º–æ) |
| **UX (export)** | ‚úÖ 500-800ms –∑–∞–¥–µ—Ä–∂–∫–∞ (–æ—Ç–ª–∏—á–Ω–æ –¥–ª—è —Ä–µ–¥–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π) |
| **OWASP compliance** | ‚ö†Ô∏è –ù–∏–∂–µ 2023, –Ω–æ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 2021 |
| **Embedded –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** | ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è ESP32 @ 240MHz |

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ #3 –∏–∑ –∞—É–¥–∏—Ç–∞: ‚úÖ –£–°–¢–†–ê–ù–ï–ù–ê

**–ü—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –∑–∞—â–∏—â—ë–Ω –æ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö GPU brute-force –∞—Ç–∞–∫ —Å –ø—Ä–∏–µ–º–ª–µ–º–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é!**

---

## üîó –°–º. —Ç–∞–∫–∂–µ

- `docs/security/wifi-credentials-encryption.md` - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ WiFi credentials
- `AUDIT_PART3_SECURITY.md` - –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `AUDIT_EXECUTIVE_SUMMARY.md` - –°–≤–æ–¥–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º
- [OWASP Password Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html)
